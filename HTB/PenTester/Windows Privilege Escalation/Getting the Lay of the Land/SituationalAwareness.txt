Network Information

Gathering network information is a crucial part of our enumeration.
We should always look at routing tables to view information about the local network and networks around it.
It is also important to use the arp command to view the ARP cache for each interface and view other hosts the host has recently communicated with.

---->>>
Interface(s), IP Address(es), DNS Information
Cmd:
ipconfig /all
->>
ARP Table
Cmd:
arp -a
->>
Routing Table
Cmd:
route print
---->>>

____________________________________
Enumerating Protections

Most modern environments have some sort of anti-virus or Endpoint Detection and Response (EDR) service running to monitor, alert on, and block threats proactively.
These tools may interfere with the enumeration process.

Many organizations utilize some sort of application whitelisting solution to control what types of applications and files certain users can run.
This may be used to attempt to block non-admin users from running cmd.exe or powershell.exe or other binaries and file types not needed for their day-to-day work.
A popular solution offered by Microsoft is AppLocker.
We can use the GetAppLockerPolicy cmdlet to enumerate the local, effective (enforced), and domain AppLocker policies.

There are ways to deal with these, and enumerating the protections in use can help us modify our tools in a lab environment and test them before using them against a client system.
Some EDR tools detect on or even block usage of common binaries such as net.exe, tasklist, etc.

---->>>>
Check Windows Defender Status
Cmd:
Get-MpComputerStatus
-->>
List AppLocker Rules
Cmd:
Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections
-->>
Test AppLocker Policy
Cmd:
Get-AppLockerPolicy -Local | Test-AppLockerPolicy -path C:\Windows\System32\cmd.exe -User Everyone
---->>>>

