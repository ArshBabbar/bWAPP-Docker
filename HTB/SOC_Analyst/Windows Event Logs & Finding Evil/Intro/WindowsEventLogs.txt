Windows Event Logs are an intrinsic part of the Windows Operating System, storing logs from different components of the system including the system itself, applications running on it, ETW providers, services, and others.

The logs are categorized into different event logs, such as "Application", "System", "Security", and others, to organize events based on their source or purpose.

Event logs can be accessed using the Event Viewer application or programmatically using APIs such as the Windows Event Log API.

Accessing the Windows Event Viewer as an administrative user allows us to explore the various logs available.

______________________________________

The default Windows event logs consist of Application, Security, Setup, System, and Forwarded Events.

"Forwarded Events" section is unique, showcasing event log data forwarded from other machines.

It should be noted, that the Windows Event Viewer has the ability to open and display previously saved .evtx files,
which can be then found in the "Saved Logs" section.

______________________________________
The Anatomy of an Event Log

When examining Application logs, we encounter two distinct levels of events: information and error.

Information events provide general usage details about the application, such as its start or stop events.
Conversely, error events highlight specific errors and often offer detailed insights into the encountered issues.

______________________________________
Each entry in the Windows Event Log is an "Event" and contains the following primary components:

Log Name:       The name of the event log (e.g., Application, System, Security, etc.).
Source:         The software that logged the event.
Event ID:       A unique identifier for the event.
Task Category:  This often contains a value or name that can help us understand the purpose or use of the event.
Level:          The severity of the event (Information, Warning, Error, Critical, and Verbose).
Keywords:       Keywords are flags that allow us to categorize events in ways beyond the other classification options. These are generally broad categories, such as "Audit Success" or "Audit Failure" in the Security log.
User:           The user account that was logged on when the event occurred.
OpCode:         This field can identify the specific operation that the event reports.
Logged:         The date and time when the event was logged.
Computer:       The name of the computer where the event occurred.
XML Data:       All the above information is also included in an XML format along with additional event data.

The Keywords field is particularly useful when filtering event logs for specific types of events.

Switching our focus to security logs, let's consider event ID 4624,
a commonly occurring event (detailed at https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4624).

______________________________________
Leveraging Custom XML Queries

To streamline our analysis, we can create custom XML queries to identify related events using the "Logon ID" as a starting point.
By navigating to "Filter Current Log" -> "XML" -> "Edit Query Manually,"
we gain access to a custom XML query language that enables more granular log searches.

--->
Microsoft offers informative articles on 
advanced XML filtering in the Windows Event Viewer.  ->https://techcommunity.microsoft.com/blog/askds/advanced-xml-filtering-in-the-windows-event-viewer/399761
--->

Understanding the meaning of each field in the security descriptor can be accomplished through references such as the article
ACE Strings                 ->https://learn.microsoft.com/en-us/windows/win32/secauthz/ace-strings?redirectedfrom=MSDN
and
Understanding SDDL Syntax   ->https://itconnect.uw.edu/tools-services-support/it-systems-infrastructure/msinf/other-help/understanding-sddl-syntax/

______________________________________
Useful Windows Event Logs

1.Windows System Logs
 
 1.Event ID 1074 (System Shutdown/Restart): This event log indicates when and why the system was shut down or restarted.

 2.Event ID 6005 (The Event log service was started): This event log marks the time when the Event Log Service was started.

 3.Event ID 6006 (The Event log service was stopped): This event log signifies the moment when the Event Log Service was stopped.

 4.Event ID 6013 (Windows uptime): This event occurs once a day and shows the uptime of the system in seconds.

 5.Event ID 7040 (Service status change): This event indicates a change in service startup type, which could be from manual to automatic or vice versa.

2.Windows Security Logs
 
 1.Event ID 1102 (The audit log was cleared): Clearing the audit log is often a sign of an attempt to remove evidence of an intrusion or malicious activity.

 2.Event ID 1116 (Antivirus malware detection): This event is particularly important because it logs when Defender detects a malware.

 3.Event ID 1118 (Antivirus remediation activity has started): This event signifies that Defender has begun the process of removing or quarantining detected malware.

 4.Event ID 1119 (Antivirus remediation activity has succeeded): This event signifies that the remediation process for detected malware has been successful.

 5.Event ID 1120 (Antivirus remediation activity has failed): This event is the counterpart to 1119 and indicates that the remediation process has failed.

 6.Event ID 4624 (Successful Logon): This event records successful logon events.

 7.Event ID 4625 (Failed Logon): This event logs failed logon attempts.

 8.Event ID 4648 (A logon was attempted using explicit credentials): This event is triggered when a user logs on with explicit credentials to run a program.

 9.Event ID 4656 (A handle to an object was requested): This event is triggered when a handle to an object (like a file, registry key, or process) is requested.

 10.Event ID 4672 (Special Privileges Assigned to a New Logon): This event is logged whenever an account logs on with super user privileges.

 11.Event ID 4698 (A scheduled task was created): This event is triggered when a scheduled task is created.

 12.Event ID 4700 & Event ID 4701 (A scheduled task was enabled/disabled): This records the enabling or disabling of a scheduled task.

 13.Event ID 4702 (A scheduled task was updated): Similar to 4698, this event is triggered when a scheduled task is updated.

 14.Event ID 4719 (System audit policy was changed): This event records changes to the audit policy on a computer.

 15.Event ID 4738 (A user account was changed): This event records any changes made to user accounts, including changes to privileges, group memberships, and account settings.

 16.Event ID 4771 (Kerberos pre-authentication failed): This event is similar to 4625 (failed logon) but specifically for Kerberos authentication.

 17.Event ID 4776 (The domain controller attempted to validate the credentials for an account): This event helps track both successful and failed attempts at credential validation by the domain controller.

 18.Event ID 5001 (Antivirus real-time protection configuration has changed): This event indicates that the real-time protection settings of Defender have been modified.

 19.Event ID 5140 (A network share object was accessed): This event is logged whenever a network share is accessed.

 20.Event ID 5142 (A network share object was added): This event signifies the creation of a new network share.

 21.Event ID 5145 (A network share object was checked to see whether client can be granted desired access): This event indicates that someone attempted to access a network share.

 22.Event ID 5157 (The Windows Filtering Platform has blocked a connection): This is logged when the Windows Filtering Platform blocks a connection attempt.

 23.Event ID 7045 (A service was installed in the system): A sudden appearance of unknown services might suggest malware installation, as many types of malware install themselves as services.

