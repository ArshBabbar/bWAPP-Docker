overview of the key Windows artifacts and forensic procedures

1.NTFS
 NTFS (New Technology File System) is a proprietary file system developed by Microsoft as a part of its Windows NT operating system family.

Here are some of the key forensic artifacts that digital investigators often analyze when working with NTFS file systems:
 
 File Metadata: NTFS stores extensive metadata for each file, including creation time, modification time, access time, and attribute information (such as read-only, hidden, or system file attributes).

 MFT Entries: The Master File Table (MFT) is a crucial component of NTFS that stores metadata for all files and directories on a volume.
 
 File Slack and Unallocated Space: Unallocated space on an NTFS volume may contain remnants of deleted files or fragments of data.

 File Signatures: File headers and signatures can be useful in identifying file types even when file extensions have been changed or obscured.

 USN Journal: The Update Sequence Number (USN) Journal is a log maintained by NTFS to record changes made to files and directories.

 LNK Files: Windows shortcut files (LNK files) contain information about the target file or program, as well as timestamps and metadata.

 Prefetch Files: Prefetch files are generated by Windows to improve the startup performance of applications.

 Registry Hives: While not directly related to the file system, Windows Registry hives contain important configuration and system information.

 Shellbags: Shellbags are registry entries that store folder view settings, such as window positions and sorting preferences.

 Thumbnail Cache: Thumbnail caches store miniature previews of images and documents.

 Recycle Bin: The Recycle Bin contains files that have been deleted from the file system.

 Alternate Data Streams (ADS): ADS are additional streams of data associated with files.

 Volume Shadow Copies: NTFS supports Volume Shadow Copies, which are snapshots of the file system at different points in time.

 Security Descriptors and ACLs: Access Control Lists (ACLs) and security descriptors determine file and folder permissions.

_______________________________
Windows Event Logs

Windows Event Logs are an intrinsic part of the Windows Operating System, storing logs from different components of the system including the system itself, applications running on it, ETW providers, services, and others.

To access the logs directly for offline analysis, investigators should navigate to the default file path for log storage at C:\Windows\System32\winevt\logs.

_______________________________
Execution Artifacts

Windows execution artifacts refer to the traces and evidence left behind on a Windows operating system when programs and processes are executed.

By examining execution artifacts, investigators can reconstruct timelines, identify malicious activities, and establish patterns of behavior.
Here are some common types of Windows execution artifacts:

1.Prefetch Files: Windows maintains a prefetch folder that contains metadata about the execution of various applications.
2.Shimcache: Shimcache is a Windows mechanism that logs information about program execution to assist with compatibility and performance optimizations.
3.Amcache: Amcache is a database introduced in Windows 8 that stores information about installed applications and executables.
4.UserAssist: UserAssist is a registry key that maintains information about programs executed by users.
5.RunMRU Lists: The RunMRU (Most Recently Used) lists in the Windows Registry store information about recently executed programs from various locations, such as the Run and RunOnce keys.
6.Jump Lists: Jump Lists store information about recently accessed files, folders, and tasks associated with specific applications.
7.Shortcut (LNK) Files: Shortcut files can contain information about the target executable, file paths, timestamps, and user interactions.
8.Recent Items: The Recent Items folder maintains a list of recently opened files.
9.Windows Event Logs: Various Windows event logs, such as the Security, Application, and System logs, record events related to program execution, including process creation and termination, application crashes, and more.

_______________________________

Artifact	              |                 Location/Registry Key	               | Data Stored
______________________________________________________________________________________________________________________________________
Prefetch Files	          | C:\Windows\Prefetch	                                   | Metadata about executed applications (file paths, timestamps, execution count)
______________________________________________________________________________________________________________________________________
Shimcache	              | Registry: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\ | Program execution details (file paths, timestamps, flags)
                          | Control\Session Manager\AppCompatCache                 |
______________________________________________________________________________________________________________________________________
Amcache	                  | C:\Windows\AppCompat\Programs\Amcache.hve              | Application details (file paths, sizes, digital signatures, timestamps)
                          | (Binary Registry Hive)                                 |
______________________________________________________________________________________________________________________________________
UserAssist	              | Registry: HKEY_CURRENT_USER\Software\Microsoft\        | Executed program details (application names, execution counts, timestamps)
                          | Windows\CurrentVersion\Explorer\UserAssist	           |
______________________________________________________________________________________________________________________________________
RunMRU Lists	          | Registry: HKEY_CURRENT_USER\Software\Microsoft\        | Recently executed programs and their command lines
                          | Windows\CurrentVersion\Explorer\RunMRU	               |
______________________________________________________________________________________________________________________________________
Jump Lists    	          | User-specific folders                                  | Recently accessed files, folders, and tasks associated with applications
                          | (e.g., %AppData%\Microsoft\Windows\Recent)	           |
______________________________________________________________________________________________________________________________________
Shortcut (LNK) Files	  | Various locations (e.g., Desktop, Start Menu)	       | Target executable, file paths, timestamps, user interactions
______________________________________________________________________________________________________________________________________
Recent Items	          | User-specific folders                                  | Recently accessed files
                          | (e.g., %AppData%\Microsoft\Windows\Recent)	           |
______________________________________________________________________________________________________________________________________
Windows Event Logs	      | C:\Windows\System32\winevt\Logs	                       | Various event logs containing process creation, termination, and other events

_______________________________
Windows Persistence Artifacts

Windows persistence refers to the techniques and mechanisms used by attackers to ensure their unauthorized presence and control over a compromised system, allowing them to maintain access and control even after initial intrusion.
These persistence methods exploit various system components, such as registry keys, startup processes, scheduled tasks, and services, enabling malicious actors to withstand reboots and security measures while continuing to carry out their objectives undetected.


---->>>>
Registry

The Windows Registry acts as a crucial database, storing critical system settings for the Windows OS.
This encompasses configurations for devices, security, services, and even the storage of user account security configurations in the Security Accounts Manager (SAM).
Therefore, it's essential to routinely inspect Registry autorun keys.

Example of Autorun keys used for persistence:

Run/RunOnce Keys

HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\
Keys used by WinLogon Process

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell
Startup Keys

HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User

---->>>>
Schtasks

Windows provides a feature allowing programs to schedule specific tasks. These tasks reside in C:\Windows\System32\Tasks, with each one saved as an XML file.
To scrutinize scheduled tasks, we should navigate to C:\Windows\System32\Tasks and examine the XML files' content.

---->>>>
Services

Services in Windows are pivotal for maintaining processes on a system, enabling software components to operate in the background without user intervention.
The registry location to keep an eye on is: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services.

_______________________________
Web Browser Forensics

Some of the pivotal browser forensic artifacts include:

Browsing History: Records of websites visited, including URLs, titles, timestamps, and visit frequency.
Cookies: Small data files stored by websites on a user's device, containing information such as session details, preferences, and authentication tokens.
Cache: Cached copies of web pages, images, and other content visited by the user. Can reveal websites accessed even if the history is cleared.
Bookmarks/Favorites: Saved links to frequently visited websites or pages of interest.
Download History: Records of downloaded files, including source URLs, filenames, and timestamps.
Autofill Data: Information automatically entered into forms, such as names, addresses, and passwords.
Search History: Queries entered into search engines, along with search terms and timestamps.
Session Data: Information about active browsing sessions, tabs, and windows.
Typed URLs: URLs entered directly into the address bar.
Form Data: Information entered into web forms, such as login credentials and search queries.
Passwords: Saved or autofilled passwords for websites.
Web Storage: Local storage data used by websites for various purposes.
Favicons: Small icons associated with websites, which can reveal visited sites.
Tab Recovery Data: Information about open tabs and sessions that can be restored after a browser crash.
Extensions and Add-ons: Installed browser extensions and their configurations.

_______________________________
SRUM

Switching gears to SRUM (System Resource Usage Monitor), it's a feature introduced in Windows 8 and subsequent versions.
SRUM meticulously tracks resource utilization and application usage patterns.
The data is housed in a database file named sru.db found in the C:\Windows\System32\sru directory.

Key facets of SRUM forensics encompass:

Application Profiling: SRUM can provide a comprehensive view of the applications and processes that have been executed on a Windows system.
Resource Consumption: SRUM captures data on CPU time, network usage, and memory consumption for each application and process.
Timeline Reconstruction: By analyzing SRUM data, digital forensics experts can create timelines of application and process execution, resource usage, and system activities.
User and System Context: SRUM data includes user identifiers, which helps in attributing activities to specific users.
Malware Analysis and Detection: SRUM data can be used to identify unusual or unauthorized applications that may be indicative of malware or malicious activities.
Incident Response: During incident response, SRUM can provide rapid insights into recent application and process activities, enabling analysts to quickly identify potential threats and respond effectively.

